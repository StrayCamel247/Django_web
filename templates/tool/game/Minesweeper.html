<!DOCTYPE html>
<html lang="ch">
<head>
    <meta charset="UTF-8">
    <title>æ‰«é›·</title>
    <style type="text/css">
    table
    {
    -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Chrome/Safari/Opera */
    -khtml-user-select: none; /* Konqueror */
    -moz-user-select: none; /* Firefox */
    -ms-user-select: none; /* Internet Explorer/Edge */
    user-select: none; /* Non-prefixed version, currently not supported by any browser */
    }
    </style>
</head>
<body>
    <center style="margin:150px auto;">
<h2 style="font-family:Comic Sans Ms;">Mine Sweeperï¼ˆæ‰«é›·ï¼‰&diams;</h2>
<p>è¯·è®¾ç½®è¡Œå’Œåˆ—å¼€å§‹æ¸¸æˆ</p>
<p>æ¸¸æˆéš¾åº¦ï¼š<select id="level" onchange="changelevel()"><option>å°ç™½çº§</option><option>å¤§ç¥çº§</option></select></p>
<p id="select_level"></p>
è¡Œ:  <input type="text" id="rows">
åˆ—: <input type="text" id="cols">
<button id="add" onClick="add()">PlayGame</button>
<br>
<p id="tips"></p>
<p id="leiNum"></p>
<table border="2" id="tab"  ></table>
<p id="GScore"></p>

</center>

<script type="text/javascript">

	var  lei =new Array("&hearts;","0","&hearts;","&hearts;","&hearts;","&hearts;");
	var tab =$("tab");
	var GScore=$("GScore");
	var score=0;
	var tip=$("tips");
	var time;
	var i=3;
	var row =$("rows");
	var col =$("cols");
	var Total=0;
	var lei_count =0;
	var levels= $("level");
	var select_level=$("select_level");

	function add()
	{
		clear();
		tip.innerHTML="æ¸¸æˆå¼€å§‹";
		score=0;
		GScore.innerHTML="å½“å‰å¾—åˆ†ï¼š"+score;
	    lei_count=0;
		tab.innerHTML="";
		Total=0;
		Total=parseInt(row.value)*parseInt(col.value);
		for(var i = 0;i < row.value;i++)
		{
			var newTr =document.createElement("tr");
			newTr.id = i;
			newTr.style.background="black";
			for(var j=0;j<col.value;j++)
			{
				var rand=parseInt(Math.random()*lei.length);
				newTr.innerHTML+="<td ><button id='"+i+","+j+"' style ='width:25px;height:25px;background:green; color:green; border:1px blue solid' onclick='myclick(this)' onmouseover='changecolor(this)' onmouseout='resetcolor(this)'>"+lei[rand]+"</button></td>";
				if(lei[rand]=="0")
				{
					lei_count++;
				}
			}
			tab.appendChild(newTr);
		}
		Total=Total-lei_count;
		var leinum =$("leiNum");
		leinum.innerHTML="æœ¬å±€é›·æ•°ï¼š"+lei_count;
	}

		function $(id)
		{
			return document.getElementById(id);
		}

	function change(obj)
	{

		if(obj.innerHTML=="0")
			{
				time=setInterval(times,1000);
				obj.style.backgroundColor="red";
				obj.innerHTML="ğŸ’€";
				alert("æ¸¸æˆç»“æŸï¼\nGame Over!");

			}else
			{
				obj.style.backgroundColor="white";
				score=score+1;
			}
			GScore.innerHTML="å½“å‰å¾—åˆ†ï¼š"+score;
	}

	function myclick(obj)
	{
		if(obj.style.background!="white")
		{
		change(obj);
		check(obj);
		Total--;
		if(Total==0)
		{
		alert("ä½ èµ¢äº†ï¼æ€»åˆ†ï¼š"+score);
		}

		}
	}


	function changecolor(obj)
	{
		obj.style.border="1px  red solid ";
	}
	function resetcolor(obj)
	{
		obj.style.border="1px blue solid";
	}
	function times()
	{

		tip.innerHTML="æ¸¸æˆç»“æŸï¼Œ"+i+"ç§’åé‡æ–°å¼€å§‹æ¸¸æˆ";
		if(i==0)
		{
			add();
		}
		i--;
	}
	function clear()
	{
		clearInterval(time);
		i=3;
	}

	function check(obj)
	{
		var index=0;
		var len =obj.id.split(",");
		index=Number(len[1]);//ä¸‹æ ‡
		var boom =0;

		//å·¦èŠ‚ç‚¹
		if(index-1>=0)
		{
			if(obj.parentNode.previousSibling.childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.previousSibling.childNodes[0].style.background="black";
			}
		}
		//å³èŠ‚ç‚¹
		if(index!=Number(col.value)-1){
			if(obj.parentNode.nextSibling.childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.nextSibling.childNodes[0].style.background="black";
			}
		}
		//ä¸ŠèŠ‚ç‚¹
		if(obj.parentNode.parentNode.id!="0"){
			if(obj.parentNode.parentNode.previousSibling.childNodes[index].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.previousSibling.childNodes[index].childNodes[0].style.background="black";
			}
		}
		//ä¸‹èŠ‚ç‚¹
		if(obj.parentNode.parentNode.id!=Number(row.value)-1){
			if(obj.parentNode.parentNode.nextSibling.childNodes[index].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.nextSibling.childNodes[index].childNodes[0].style.background="black";
			}
		}

		//å·¦ä¸ŠèŠ‚ç‚¹
		if(index-1>=0 && obj.parentNode.parentNode.id!="0"){
			if(obj.parentNode.parentNode.previousSibling.childNodes[index-1].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.previousSibling.childNodes[index-1].childNodes[0].style.background="black";
			}
		}

		//å³ä¸ŠèŠ‚ç‚¹
		if(index!=Number(col.value)-1 && obj.parentNode.parentNode.id!="0"){
			if(obj.parentNode.parentNode.previousSibling.childNodes[index+1].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.previousSibling.childNodes[index+1].childNodes[0].style.background="black";
			}
		}
		//å·¦ä¸‹èŠ‚ç‚¹
		if(index-1>=0 && obj.parentNode.parentNode.id!=Number(row.value)-1){
			if(obj.parentNode.parentNode.nextSibling.childNodes[index-1].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.nextSibling.childNodes[index-1].childNodes[0].style.background="black";
			}
		}
		//å³ä¸‹èŠ‚ç‚¹
		if(index!=Number(col.value)-1  && obj.parentNode.parentNode.id!=Number(row.value)-1){
			if(obj.parentNode.parentNode.nextSibling.childNodes[index+1].childNodes[0].innerHTML=="0")
			{
			boom++;
			if(levels.value=="å°ç™½çº§")
			obj.parentNode.parentNode.nextSibling.childNodes[index+1].childNodes[0].style.background="black";
			}
		}

 if(boom>0)
		obj.innerHTML=boom;
else
obj.innerHTML="&nbsp;";


	}


	function changelevel()
	{
		var info=levels.value;
		if(levels.value=="å°ç™½çº§")
		{
			info+="&nbsp;(è‡ªåŠ¨æ’é›·)"+"ğŸ’€";
		}
		else
		{
			info+="ğŸ’€ğŸ’€ğŸ’€";
		}

		select_level.innerHTML="ä½ å·²é€‰æ‹©ï¼š"+info;
	}

	window.onload=changelevel;

	</script>
</body>
</html>